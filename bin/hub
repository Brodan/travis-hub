#!/usr/bin/env ruby

$stdout.sync = true

$LOAD_PATH << 'lib'

require 'optparse'
require 'bundler/setup'
require 'travis/hub'

def options_parser(options)
  options[:retries] = 3

  OptionParser.new do |o|
    o.on('-n', '--number NUMBER', 'Worker number') do |number|
      options[:number] = number.to_i
    end

    o.on('-c', '--count COUNT', 'Workers count') do |count|
      options[:count] = count.to_i
    end
  end
end

options = {}
options_parser(options).parse!
mode = ARGV.shift || :solo

Travis::Hub::App.run(mode.to_sym, options)
